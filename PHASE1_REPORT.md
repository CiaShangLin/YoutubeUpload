# Phase 1 å®Œæˆå ±å‘Šï¼šToken ç®¡ç†å™¨ + éæœŸæª¢æŸ¥ UI

## âœ… å·²å®Œæˆé …ç›®

### 1. Token ç®¡ç†å™¨ (`token_manager.py`)

**åŠŸèƒ½ï¼š**
- âœ… çµ±ä¸€ç®¡ç† YouTube å’Œ Google Drive çš„ OAuth Token
- âœ… æª¢æŸ¥æ‰€æœ‰ Token çš„éæœŸç‹€æ…‹
- âœ… è‡ªå‹•åˆ·æ–°éæœŸçš„ Tokenï¼ˆä½¿ç”¨ refresh_tokenï¼‰
- âœ… æä¾›é‡æ–°èªè­‰åŠŸèƒ½
- âœ… ä½¿ç”¨æ–°ç‰ˆ `google-auth` åº«ï¼ˆå–ä»£èˆŠç‰ˆ `oauth2client`ï¼‰

**APIï¼š**
```python
manager = TokenManager()

# æª¢æŸ¥æ‰€æœ‰ Token ç‹€æ…‹
statuses = manager.check_all_tokens()  # è¿”å› Dict[str, TokenStatus]

# åˆ·æ–°æŒ‡å®š Token
success = manager.refresh_token('youtube')  # æˆ– 'google_drive'

# é‡æ–°èªè­‰
success = manager.authenticate('youtube')  # æˆ– 'google_drive'

# å–å¾—æ†‘è­‰ï¼ˆè‡ªå‹•è™•ç†éæœŸåˆ·æ–°ï¼‰
creds = manager.get_youtube_credentials()
creds = manager.get_google_drive_credentials()
```

---

### 2. Token ç‹€æ…‹å°è©±æ¡† (`dialogs/token_status_dialog.py`)

**åŠŸèƒ½ï¼š**
- âœ… è¦–è¦ºåŒ–é¡¯ç¤ºæ‰€æœ‰ Token çš„ç‹€æ…‹
- âœ… é¡¯ç¤ºéæœŸæ™‚é–“
- âœ… æä¾›ã€Œåˆ·æ–° Tokenã€æŒ‰éˆ•ï¼ˆç•¶ Token å¯åˆ·æ–°æ™‚ï¼‰
- âœ… æä¾›ã€Œé‡æ–°èªè­‰ã€æŒ‰éˆ•ï¼ˆç•¶ Token ç„¡æ•ˆæ™‚ï¼‰
- âœ… é‡æ–°æª¢æŸ¥åŠŸèƒ½

**UI é è¦½ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  OAuth Token ç‹€æ…‹æª¢æŸ¥                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€ YouTube â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ âŒ å·²éæœŸæˆ–ç„¡æ•ˆ                        â”‚  â”‚
â”‚  â”‚ è©³æƒ…: Token ä¸å­˜åœ¨æˆ–ç„¡æ•ˆï¼Œéœ€è¦é‡æ–°èªè­‰  â”‚  â”‚
â”‚  â”‚ [ğŸ” é‡æ–°èªè­‰]                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚  â”Œâ”€ Google Drive â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ âŒ å·²éæœŸæˆ–ç„¡æ•ˆ                        â”‚  â”‚
â”‚  â”‚ è©³æƒ…: Token ä¸å­˜åœ¨æˆ–ç„¡æ•ˆï¼Œéœ€è¦é‡æ–°èªè­‰  â”‚  â”‚
â”‚  â”‚ [ğŸ” é‡æ–°èªè­‰]                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                             â”‚
â”‚                  [ğŸ”„ é‡æ–°æª¢æŸ¥]  [é—œé–‰]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### 3. æ•´åˆåˆ°ä¸»ç¨‹å¼ (`main.py`)

**è®Šæ›´ï¼š**
- âœ… å¼•å…¥ `TokenManager` å’Œ `TokenStatusDialog`
- âœ… åœ¨ UI å³ä¸Šè§’åŠ å…¥ã€ŒğŸ” æª¢æŸ¥ Tokenã€æŒ‰éˆ•
- âœ… é»æ“ŠæŒ‰éˆ•é–‹å•Ÿ Token ç‹€æ…‹å°è©±æ¡†
- âœ… åˆå§‹åŒ– `self.token_manager` ä¾›å¾ŒçºŒä½¿ç”¨

**æ–°å¢æŒ‰éˆ•ä½ç½®ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                      [ğŸ” æª¢æŸ¥ Token]   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [é¸æ“‡æª”æ¡ˆ] /path/to/video.mp4                        â”‚
â”‚  ...                                                   â”‚
```

---

### 4. ä¾è³´å¥—ä»¶ç®¡ç†

**æ–°å¢æª”æ¡ˆï¼š**
- âœ… `requirements.txt` - åˆ—å‡ºæ‰€æœ‰å°ˆæ¡ˆä¾è³´

**å·²å®‰è£å¥—ä»¶ï¼š**
- âœ… `google-auth` - æ–°ç‰ˆ Google èªè­‰åº«
- âœ… `google-auth-oauthlib` - OAuth æµç¨‹æ”¯æ´
- âœ… `google-auth-httplib2` - HTTP å‚³è¼¸å±¤

---

## ğŸ“ æ–°å¢æª”æ¡ˆæ¸…å–®

```
YoutubeUpload/
â”œâ”€â”€ token_manager.py              âœ¨ NEW - Token çµ±ä¸€ç®¡ç†å™¨
â”œâ”€â”€ dialogs/
â”‚   â”œâ”€â”€ __init__.py               âœ¨ NEW - æ¨¡çµ„åˆå§‹åŒ–
â”‚   â””â”€â”€ token_status_dialog.py    âœ¨ NEW - Token ç‹€æ…‹å°è©±æ¡†
â”œâ”€â”€ test_token_dialog.py          âœ¨ NEW - æ¸¬è©¦è…³æœ¬
â”œâ”€â”€ requirements.txt              âœ¨ NEW - ä¾è³´å¥—ä»¶æ¸…å–®
â””â”€â”€ main.py                       ğŸ”§ MODIFIED - åŠ å…¥ Token æª¢æŸ¥æŒ‰éˆ•
```

---

## ğŸ§ª æ¸¬è©¦æ–¹å¼

### æ¸¬è©¦ Token ç®¡ç†å™¨ï¼ˆå‘½ä»¤åˆ—ï¼‰
```bash
cd /Users/tsaishanglin/Documents/vscode/YoutubeUpload
python3 token_manager.py
```

**é æœŸè¼¸å‡ºï¼š**
```
=== Token ç‹€æ…‹æª¢æŸ¥ ===

YouTube:
  âŒ å·²éæœŸæˆ–ç„¡æ•ˆ
  éŒ¯èª¤: Token ä¸å­˜åœ¨æˆ–ç„¡æ•ˆï¼Œéœ€è¦é‡æ–°èªè­‰

Google Drive:
  âŒ å·²éæœŸæˆ–ç„¡æ•ˆ
  éŒ¯èª¤: Token ä¸å­˜åœ¨æˆ–ç„¡æ•ˆï¼Œéœ€è¦é‡æ–°èªè­‰
```

### æ¸¬è©¦ Token ç‹€æ…‹å°è©±æ¡†ï¼ˆGUIï¼‰
```bash
python3 test_token_dialog.py
```

### æ¸¬è©¦å®Œæ•´ç¨‹å¼
```bash
python3 main.py
```
é»æ“Šå³ä¸Šè§’çš„ã€ŒğŸ” æª¢æŸ¥ Tokenã€æŒ‰éˆ•ã€‚

---

## ğŸ”§ Token å„ªåŒ–èªªæ˜

### èˆŠç‰ˆ vs æ–°ç‰ˆå°æ¯”

| é …ç›® | èˆŠç‰ˆ (oauth2client) | æ–°ç‰ˆ (google-auth) |
|------|-------------------|-------------------|
| ç¶­è­·ç‹€æ…‹ | âŒ å·²æ£„ç”¨ | âœ… å®˜æ–¹ç¶­è­· |
| è‡ªå‹•åˆ·æ–° | âŒ éœ€æ‰‹å‹•è™•ç† | âœ… å…§å»ºæ”¯æ´ |
| Token å„²å­˜ | JSON æ ¼å¼ | Pickle æ ¼å¼ |
| éæœŸæª¢æŸ¥ | `credentials.invalid` | `credentials.valid` / `credentials.expired` |
| åˆ·æ–°æ–¹æ³• | ç„¡çµ±ä¸€æ–¹æ³• | `credentials.refresh(Request())` |

### æ–°ç‰ˆå„ªå‹¢

1. **çµ±ä¸€ç®¡ç†**ï¼šæ‰€æœ‰ Token é€é `TokenManager` é›†ä¸­ç®¡ç†
2. **è‡ªå‹•åˆ·æ–°**ï¼š`get_youtube_credentials()` æœƒè‡ªå‹•æª¢æŸ¥ä¸¦åˆ·æ–°éæœŸçš„ Token
3. **éŒ¯èª¤è™•ç†**ï¼šå®Œæ•´çš„ try-except è™•ç†ï¼Œé¿å…ç¨‹å¼å´©æ½°
4. **è¦–è¦ºåŒ–æª¢æŸ¥**ï¼šé€é GUI å°è©±æ¡†ç›´è§€æŸ¥çœ‹ Token ç‹€æ…‹

---

## âš ï¸ é—œæ–¼ä¸€é€±éæœŸå•é¡Œ

å¦‚æœæ‚¨çš„ Token æ¯é€±éƒ½æœƒéæœŸï¼Œå¯èƒ½æ˜¯å› ç‚º Google Cloud å°ˆæ¡ˆè™•æ–¼ã€Œæ¸¬è©¦æ¨¡å¼ã€ã€‚

**è§£æ±ºæ–¹æ³•ï¼š**
1. å‰å¾€ [Google Cloud Console](https://console.cloud.google.com/)
2. é¸æ“‡æ‚¨çš„å°ˆæ¡ˆ
3. é€²å…¥ã€ŒOAuth åŒæ„ç•«é¢ã€
4. å°‡ç™¼å¸ƒç‹€æ…‹å¾ã€Œæ¸¬è©¦ã€æ”¹ç‚ºã€Œæ­£å¼ç‰ˆã€

é€™æ¨£ refresh_token å°±ä¸æœƒæ¯é€±éæœŸäº†ï¼

---

## ğŸ¯ ä¸‹ä¸€æ­¥ï¼šPhase 2

Phase 1 å·²å®Œæˆï¼æ¥ä¸‹ä¾†å¯ä»¥é€²è¡Œï¼š

**Phase 2ï¼šå½±ç‰‡è³‡æ–™æ¨¡å‹ + æ‰¹æ¬¡åˆ—è¡¨ UI**
- å‰µå»º `video_item.py` - å½±ç‰‡è³‡æ–™æ¨¡å‹
- å‰µå»ºæ‰¹æ¬¡å½±ç‰‡åˆ—è¡¨ UI
- å¯¦ä½œæ–°å¢/ç§»é™¤/ç·¨è¼¯å½±ç‰‡åŠŸèƒ½

æº–å‚™å¥½å¾Œè«‹å‘ŠçŸ¥ï¼Œæˆ‘å°‡ç¹¼çºŒå¯¦ä½œï¼
